 Script de auditor铆a de permisos IAM (read-only)
audit_vertex_iam.py
#!/usr/bin/env python3
# DEMO ONLY
"""
Auditor铆a read-only de permisos IAM relacionados con Vertex AI.
No modifica recursos ni permisos.
"""

from google.cloud import resourcemanager_v3
from google.cloud import iam_v1

PROJECT_ID = "your-project-id"

def audit_iam():
    print("[*] Iniciando auditor铆a IAM (read-only)")
    client = resourcemanager_v3.ProjectsClient()
    project_name = f"projects/{PROJECT_ID}"

    policy = client.get_iam_policy(request={"resource": project_name})

    for binding in policy.bindings:
        role = binding.role
        if "aiplatform" in role or "serviceAccount" in role:
            print(f"\n[+] Rol detectado: {role}")
            for member in binding.members:
                print(f"    - {member}")

if __name__ == "__main__":
    audit_iam()

锔 Script de detecci贸n de configuraciones inseguras
detect_insecure_vertex_configs.py
#!/usr/bin/env python3
# DEMO ONLY
"""
Detecta configuraciones potencialmente inseguras en Vertex AI.
No ejecuta cambios ni explotaci贸n.
"""

from google.cloud import aiplatform

PROJECT_ID = "your-project-id"
REGION = "us-central1"

def detect_configs():
    print("[*] Analizando configuraciones de Vertex AI")
    aiplatform.init(project=PROJECT_ID, location=REGION)

    engines = aiplatform.ReasoningEngine.list()
    for engine in engines:
        print(f"\n[+] Reasoning Engine: {engine.display_name}")
        print("    - Revisar permisos de update")
        print("    - Validar tools din谩micas")
        print("    - Verificar cuenta de servicio asociada")

    resources = aiplatform.PersistentResource.list()
    for res in resources:
        print(f"\n[+] Persistent Resource (Ray): {res.resource_name}")
        print("    - Verificar shell interactiva")
        print("    - Validar controles de acceso")

if __name__ == "__main__":
    detect_configs()

И Script de validaci贸n de exposici贸n de TorchServe (sin explotaci贸n)
check_torchserve_config.py
#!/usr/bin/env python3
# DEMO ONLY
"""
Valida configuraci贸n de TorchServe sin interactuar con la API de management.
"""

import os

TORCHSERVE_CONFIG = "/etc/torchserve/config.properties"

def check_config():
    print("[*] Validando configuraci贸n TorchServe (local)")

    if not os.path.exists(TORCHSERVE_CONFIG):
        print("[-] Archivo de configuraci贸n no encontrado")
        return

    with open(TORCHSERVE_CONFIG, "r") as f:
        content = f.read()

    if "management_address=0.0.0.0" in content:
        print("[!] Configuraci贸n insegura detectada: management_address expuesta")
    else:
        print("[+] management_address configurada correctamente")

    if "allowed_urls=*" in content:
        print("[!] allowed_urls demasiado permisivo")
    else:
        print("[+] allowed_urls restringido")

if __name__ == "__main__":
    check_config()

 Scripts de logging y evidencia
collect_vertex_logs.py
#!/usr/bin/env python3
# DEMO ONLY
"""
Simula la recolecci贸n de logs relevantes para investigaci贸n forense.
No accede a logs reales.
"""

import datetime

def collect_logs():
    timestamp = datetime.datetime.utcnow().isoformat()
    print(f"[*] Recolecci贸n de logs simulada - {timestamp}")

    simulated_logs = [
        "INFO VertexAI ReasoningEngine accessed",
        "WARN Service Agent activity anomaly detected",
        "INFO PersistentResource shell access attempt blocked"
    ]

    for log in simulated_logs:
        print(log)

if __name__ == "__main__":
    collect_logs()

Ь Script de evidencia consolidada
generate_evidence_report.py
#!/usr/bin/env python3
# DEMO ONLY
"""
Genera un reporte de evidencia basado en hallazgos simulados.
"""

def generate_report():
    print("=== Evidence Report (Simulation) ===")
    print("- IAM roles excesivos detectados")
    print("- Shell interactiva habilitada (riesgo)")
    print("- Configuraci贸n TorchServe validada")
    print("- No se ejecut贸 explotaci贸n")
    print("=== Fin del reporte ===")

if __name__ == "__main__":
    generate_report()
